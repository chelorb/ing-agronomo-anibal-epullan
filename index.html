<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Registro de Aplicaciones - Ing. An√≠bal Epull√°n</title>

  <!-- ‚úÖ Manifest y meta para PWA -->
  <link rel="manifest" href="manifest.json">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Registro Agro">
  <link rel="apple-touch-icon" href="logo-192.png">

  <!-- ‚úÖ Estilos -->
  <link rel="stylesheet" href="styles.css">

  <!-- ‚úÖ Librer√≠as para exportar -->
  <script src="https://cdn.sheetjs.com/xlsx-0.20.3/package/dist/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
</head>

<body>
  <!-- ================================================= -->
  <!-- üß≠ ENCABEZADO -->
  <!-- ================================================= -->
  <header class="topbar">
    <img src="logo-192.png" alt="logo" id="logo">
    <div>
      <h1>Registro de Aplicaciones</h1>
      <small id="subtitle">Ing. Agr√≥nomo An√≠bal Epull√°n</small><br>
      <small>Mail: <a href="mailto:Anibalepullan1@gmail.com">Anibalepullan1@gmail.com</a> | Tel: 298 4687873</small>
    </div>
  </header>

  <!-- ================================================= -->
  <!-- üßæ FORMULARIO PRINCIPAL -->
  <!-- ================================================= -->
  <main class="container">
    <form id="workForm">
      <input type="hidden" id="editId" />

      <div class="row">
        <label>Fecha</label>
        <input type="date" id="fecha" required />
      </div>

      <div class="row">
        <label>Cliente</label>
        <input type="text" id="cliente" placeholder="Nombre del cliente" required />
      </div>

      <div class="row">
        <label>Ubicaci√≥n</label>
        <input type="text" id="ubicacion" placeholder="Direcci√≥n / predio / coordenadas" />
      </div>

      <div class="row">
        <label>Superficie</label>
        <input type="number" id="superficie" step="0.01" placeholder="ej: 2.5" />
        <select id="unidad">
          <option value="ha">ha</option>
          <option value="m2">m¬≤</option>
        </select>
      </div>

      <fieldset id="insumosField">
        <legend>Insumos utilizados (producto + litros)</legend>
        <div id="insumosList"></div>
        <button type="button" id="addInsumo">+ Agregar insumo</button>
      </fieldset>

      <div class="row">
        <label>Recomendaci√≥n del ingeniero</label>
        <textarea id="recomendacion" rows="3"></textarea>
      </div>

      <div class="row">
        <label>Observaciones</label>
        <textarea id="observaciones" rows="2"></textarea>
      </div>

      <div class="actions">
        <button type="submit">Guardar trabajo</button>
        <button type="button" id="exportExcel">Exportar Excel</button>
        <button type="button" id="exportPDF">Exportar PDF</button>
      </div>
    </form>

    <section class="list-section">
      <h2>Trabajos guardados</h2>
      <div id="trabajos"></div>
      <button id="borrarTodo" class="danger">Borrar todo</button>
    </section>
  </main>

  <!-- ================================================= -->
  <!-- üß† FIREBASE SDK -->
  <!-- ================================================= -->
  <!-- SDKs oficiales (modo compatibilidad para uso simple) -->
  <script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore-compat.js"></script>

  <script>
    // üöÄ CONFIGURACI√ìN DE FIREBASE (reemplaz√° con los datos de tu proyecto)
    const firebaseConfig = {
  apiKey: "AIzaSyDnMeFztVPA0IoP2tABRgd8pD86qBqzWhg",
  authDomain: "ing-anibal-epullan.firebaseapp.com",
  projectId: "ing-anibal-epullan",
  storageBucket: "ing-anibal-epullan.firebasestorage.app",
  messagingSenderId: "264725993777",
  appId: "1:264725993777:web:5af48de7b1a634fe72f810",
  measurementId: "G-TE8JKYLYM9"
};

    // Inicializa Firebase
    firebase.initializeApp(firebaseConfig);

    // Inicializa Firestore (base de datos)
    const db = firebase.firestore();

    console.log("‚úÖ Firebase inicializado correctamente:", firebase.app().name);
  </script>

  <!-- ================================================= -->
  <!-- üíæ APP PRINCIPAL -->
  <!-- ================================================= -->
  <script src="app.js"></script>

  <!-- ================================================= -->
  <!-- üß± SERVICE WORKER -->
  <!-- ================================================= -->
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('./service-worker.js')
      .then(() => console.log("‚úÖ Service Worker registrado correctamente"))
      .catch(err => console.warn("‚ö†Ô∏è Error registrando el Service Worker:", err));
    }
  </script>
</body>
</html>
